


<!DOCTYPE html>
<html id="htmlId">
<head>
  <meta http-equiv="Content-Type" content="text/html;charset=UTF-8"> 
  <title>Coverage Report > Gui</title>
  <style type="text/css">
    @import "../../css/coverage.css";
    @import "../../css/idea.min.css";
  </style>
  <script type="text/javascript" src="../../js/highlight.min.js"></script>
  <script type="text/javascript" src="../../js/highlightjs-line-numbers.min.js"></script>
</head>

<body>
<div class="content">
<div class="breadCrumbs">
Current scope:     <a href="../../index.html">all classes</a>
    <span class="separator">|</span>
    <a href="../index.html">ui</a>
</div>

<h1>Coverage Summary for Class: Gui (ui)</h1>

<table class="coverageStats">

<tr>
  <th class="name">Class</th>
<th class="coverageStat 
">
  Method, %
</th>
<th class="coverageStat 
">
  Branch, %
</th>
<th class="coverageStat 
">
  Line, %
</th>
</tr>
<tr>
  <td class="name">Gui</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/23)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/66)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/413)
  </span>
</td>
</tr>
  <tr>
    <td class="name">Gui$1</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/5)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$2</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$3</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$4</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/18)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$5</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$6</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/4)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/15)
  </span>
</td>
  </tr>
  <tr>
    <td class="name">Gui$7</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/3)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/8)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/7)
  </span>
</td>
  </tr>
<tr>
  <td class="name"><strong>Total</strong></td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/44)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/106)
  </span>
</td>
<td class="coverageStat">
  <span class="percent">
    0%
  </span>
  <span class="absValue">
    (0/490)
  </span>
</td>
</tr>
</table>

<br/>
<br/>


<pre>
<code class="sourceCode" id="sourceCode">&nbsp;package ui;
&nbsp;import model.Cadastro;
&nbsp;import model.Location;
&nbsp;import service.OwnerGraph;
&nbsp;import service.PropertyGraph;
&nbsp;import core.Constants;
&nbsp;
&nbsp;import javax.swing.*;
&nbsp;import java.awt.*;
&nbsp;import java.awt.event.ActionEvent;
&nbsp;import java.io.File;
&nbsp;import java.util.ArrayList;
&nbsp;import java.util.List;
&nbsp;
&nbsp;/**
&nbsp; * Classe que implementa a interface gráfica do sistema de gestão de propriedades.
&nbsp; * Esta classe estende JFrame e fornece uma interface para importar, visualizar e gerenciar
&nbsp; * cadastros de propriedades a partir de arquivos CSV.
&nbsp; * 
&nbsp; * @author [Lei-G]
&nbsp; * @version 1.0
&nbsp; */
&nbsp;public class Gui extends JFrame {
&nbsp;    /** Text field for entering the CSV file path */
<b class="nc">&nbsp;    private final JTextField csvPathInput = new JTextField(20);</b>
&nbsp;
&nbsp;    /** Button to open file browser dialog */
<b class="nc">&nbsp;    private final JButton browseButton = new JButton(Constants.BROWSE_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to import data from CSV file */
<b class="nc">&nbsp;    private final JButton importButton = new JButton(Constants.IMPORT_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to show more results */
<b class="nc">&nbsp;    private final JButton showMore = new JButton(Constants.SHOW_MORE_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to view property graph visualization */
<b class="nc">&nbsp;    private final JButton viewPropertyGraphButton = new JButton(Constants.VIEW_PROPERTY_GRAPH_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to view owner graph visualization */
<b class="nc">&nbsp;    private final JButton viewOwnerGraphButton = new JButton(Constants.VIEW_OWNER_GRAPH_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to calculate average property area */
<b class="nc">&nbsp;    private final JButton calculatePropertyAverageButton = new JButton(Constants.AVERAGE_PROPERTY_AREA_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to calculate average owner area */
<b class="nc">&nbsp;    private final JButton calculateOwnerAverageButton = new JButton(Constants.AVERAGE_OWNER_AREA_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Button to show property exchange panel */
<b class="nc">&nbsp;    private final JButton showPropertyExchangeButton = new JButton(Constants.PROPERTY_EXCHANGE_BUTTON_TEXT);</b>
&nbsp;
&nbsp;    /** Panel for displaying results */
<b class="nc">&nbsp;    private final JPanel resultsPanel = new JPanel();</b>
&nbsp;
&nbsp;    /** List of buttons for sorting results */
<b class="nc">&nbsp;    private final List&lt;JButton&gt; sortButtons = new ArrayList&lt;&gt;();</b>
&nbsp;
&nbsp;    /** Pointer to current position in cadastros results */
&nbsp;    private int cadastrosResultPointer;
&nbsp;
&nbsp;    /** List of all cadastral properties */
&nbsp;    private List&lt;Cadastro&gt; cadastros;
&nbsp;
&nbsp;    /** Flag indicating if loading operation was cancelled */
<b class="nc">&nbsp;    private boolean loadingCancelled = false;</b>
&nbsp;
&nbsp;    /** Worker thread for property graph loading */
&nbsp;    private SwingWorker&lt;PropertyGraph, Void&gt; propertyGraphWorker;
&nbsp;
&nbsp;    /** Flag indicating if owner graph loading was cancelled */
<b class="nc">&nbsp;    private boolean ownerLoadingCancelled = false;</b>
&nbsp;
&nbsp;    /** Worker thread for owner graph loading */
&nbsp;    private SwingWorker&lt;OwnerGraph, Void&gt; ownerGraphWorker;
&nbsp;
&nbsp;    /** Flag indicating if exchange panel loading was cancelled */
<b class="nc">&nbsp;    private boolean exchangeLoadingCancelled = false;</b>
&nbsp;
&nbsp;    /** Worker thread for property exchange panel loading */
&nbsp;    private SwingWorker&lt;PropertyExchangePanel, Void&gt; exchangeWorker;
&nbsp;
&nbsp;    /**
&nbsp;     * Construtor da classe GUI.
&nbsp;     * Inicializa a interface gráfica com todos os componentes necessários,
&nbsp;     * incluindo campos para seleção de arquivo, botões de ação e painéis de resultados.
&nbsp;     * 
&nbsp;     * @throws RuntimeException se houver erro na inicialização da interface
&nbsp;     */
<b class="nc">&nbsp;    public Gui() {</b>
&nbsp;        try {
<b class="nc">&nbsp;            setTitle(Constants.WINDOW_TITLE);</b>
<b class="nc">&nbsp;            setSize(Constants.WINDOW_WIDTH, Constants.WINDOW_HEIGHT);</b>
<b class="nc">&nbsp;            setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);</b>
<b class="nc">&nbsp;            setLayout(new BorderLayout());</b>
&nbsp;            
&nbsp;            // Configurar o look and feel para o padrão do sistema
&nbsp;            try {
<b class="nc">&nbsp;                UIManager.setLookAndFeel(UIManager.getCrossPlatformLookAndFeelClassName());</b>
<b class="nc">&nbsp;                SwingUtilities.updateComponentTreeUI(this);</b>
<b class="nc">&nbsp;            } catch (Exception e) {</b>
<b class="nc">&nbsp;                e.printStackTrace();</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            initializeComponents();</b>
<b class="nc">&nbsp;            setupLayout();</b>
<b class="nc">&nbsp;            configureListeners();</b>
<b class="nc">&nbsp;        } catch (Exception e) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(&quot;Falha na inicialização da interface gráfica&quot;, e);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void initializeComponents() {
&nbsp;        // Configurar o painel principal
<b class="nc">&nbsp;        getContentPane().setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
&nbsp;        
<b class="nc">&nbsp;        csvPathInput.setEditable(false);</b>
<b class="nc">&nbsp;        csvPathInput.setBorder(BorderFactory.createCompoundBorder(</b>
<b class="nc">&nbsp;            BorderFactory.createLineBorder(Color.decode(Constants.BORDER_COLOR)),</b>
<b class="nc">&nbsp;            BorderFactory.createEmptyBorder(8, 8, 8, 8)</b>
&nbsp;        ));
<b class="nc">&nbsp;        csvPathInput.setBackground(Color.WHITE);</b>
<b class="nc">&nbsp;        csvPathInput.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
&nbsp;        
<b class="nc">&nbsp;        resultsPanel.setLayout(new BoxLayout(resultsPanel, BoxLayout.Y_AXIS));</b>
<b class="nc">&nbsp;        resultsPanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;        resultsPanel.setBorder(BorderFactory.createEmptyBorder(10, 10, 10, 10));</b>
&nbsp;        
&nbsp;        // Estilizar botões principais
<b class="nc">&nbsp;        styleButton(browseButton);</b>
<b class="nc">&nbsp;        styleButton(importButton);</b>
<b class="nc">&nbsp;        styleButton(viewPropertyGraphButton);</b>
<b class="nc">&nbsp;        styleButton(viewOwnerGraphButton);</b>
<b class="nc">&nbsp;        styleButton(calculatePropertyAverageButton);</b>
<b class="nc">&nbsp;        styleButton(calculateOwnerAverageButton);</b>
<b class="nc">&nbsp;        styleButton(showPropertyExchangeButton);</b>
&nbsp;        
<b class="nc">&nbsp;        viewPropertyGraphButton.setEnabled(false);</b>
<b class="nc">&nbsp;        viewOwnerGraphButton.setEnabled(false);</b>
<b class="nc">&nbsp;        calculatePropertyAverageButton.setEnabled(false);</b>
<b class="nc">&nbsp;        calculateOwnerAverageButton.setEnabled(false);</b>
<b class="nc">&nbsp;        showPropertyExchangeButton.setEnabled(false);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void styleButton(JButton button) {
<b class="nc">&nbsp;        button.setBackground(Color.decode(Constants.PRIMARY_COLOR));</b>
<b class="nc">&nbsp;        button.setForeground(Color.decode(Constants.BUTTON_TEXT_COLOR));</b>
<b class="nc">&nbsp;        button.setFocusPainted(false);</b>
<b class="nc">&nbsp;        button.setBorderPainted(false);</b>
<b class="nc">&nbsp;        button.setOpaque(true);</b>
<b class="nc">&nbsp;        button.setPreferredSize(new Dimension(button.getPreferredSize().width, 34));</b>
<b class="nc">&nbsp;        button.setCursor(new Cursor(Cursor.HAND_CURSOR));</b>
<b class="nc">&nbsp;        button.setFont(button.getFont().deriveFont(Font.BOLD, 12f));</b>
&nbsp;        
&nbsp;        // Adicionar efeito hover
<b class="nc">&nbsp;        button.addMouseListener(new java.awt.event.MouseAdapter() {</b>
&nbsp;            public void mouseEntered(java.awt.event.MouseEvent evt) {
<b class="nc">&nbsp;                if (button.isEnabled()) {</b>
<b class="nc">&nbsp;                    button.setBackground(Color.decode(Constants.HOVER_COLOR));</b>
&nbsp;                }
&nbsp;            }
&nbsp;
&nbsp;            public void mouseExited(java.awt.event.MouseEvent evt) {
<b class="nc">&nbsp;                if (button.isEnabled()) {</b>
<b class="nc">&nbsp;                    button.setBackground(Color.decode(Constants.PRIMARY_COLOR));</b>
&nbsp;                }
&nbsp;            }
&nbsp;        });
&nbsp;
&nbsp;        // Estilo para botão desabilitado
<b class="nc">&nbsp;        if (!button.isEnabled()) {</b>
<b class="nc">&nbsp;            button.setBackground(Color.decode(Constants.DISABLED_COLOR));</b>
<b class="nc">&nbsp;            button.setForeground(Color.decode(Constants.BORDER_COLOR));</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void setupLayout() {
<b class="nc">&nbsp;        JPanel filePanel = new JPanel(new BorderLayout(Constants.PADDING, 0));</b>
<b class="nc">&nbsp;        filePanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;        filePanel.setBorder(BorderFactory.createEmptyBorder(Constants.PADDING, Constants.PADDING, Constants.PADDING, Constants.PADDING));</b>
&nbsp;        
<b class="nc">&nbsp;        JLabel fileLabel = new JLabel(Constants.FILE_SELECTION_LABEL);</b>
<b class="nc">&nbsp;        fileLabel.setFont(fileLabel.getFont().deriveFont(Font.BOLD));</b>
<b class="nc">&nbsp;        fileLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
&nbsp;        
<b class="nc">&nbsp;        JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.LEFT, 8, 0));</b>
<b class="nc">&nbsp;        buttonPanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;        buttonPanel.add(browseButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(importButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(viewPropertyGraphButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(viewOwnerGraphButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(calculatePropertyAverageButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(calculateOwnerAverageButton);</b>
<b class="nc">&nbsp;        buttonPanel.add(showPropertyExchangeButton);</b>
&nbsp;
<b class="nc">&nbsp;        filePanel.add(fileLabel, BorderLayout.WEST);</b>
<b class="nc">&nbsp;        filePanel.add(csvPathInput, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;        filePanel.add(buttonPanel, BorderLayout.EAST);</b>
&nbsp;
<b class="nc">&nbsp;        JScrollPane scrollPane = new JScrollPane(resultsPanel);</b>
<b class="nc">&nbsp;        scrollPane.setBorder(null);</b>
<b class="nc">&nbsp;        scrollPane.getVerticalScrollBar().setUnitIncrement(16);</b>
<b class="nc">&nbsp;        scrollPane.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
&nbsp;
<b class="nc">&nbsp;        add(filePanel, BorderLayout.NORTH);</b>
<b class="nc">&nbsp;        add(scrollPane, BorderLayout.CENTER);</b>
&nbsp;    }
&nbsp;
&nbsp;    private void configureListeners() {
<b class="nc">&nbsp;        browseButton.addActionListener(this::browseFile);</b>
<b class="nc">&nbsp;        importButton.addActionListener(this::importCadastros);</b>
<b class="nc">&nbsp;        showMore.addActionListener(this::moreResults);</b>
<b class="nc">&nbsp;        viewPropertyGraphButton.addActionListener(this::showPropertyGraphVisualization);</b>
<b class="nc">&nbsp;        viewOwnerGraphButton.addActionListener(this::showOwnerGraphVisualization);</b>
<b class="nc">&nbsp;        calculatePropertyAverageButton.addActionListener(this::showPropertyAverageAreaPanel);</b>
<b class="nc">&nbsp;        calculateOwnerAverageButton.addActionListener(this::showOwnerAverageAreaPanel);</b>
<b class="nc">&nbsp;        showPropertyExchangeButton.addActionListener(this::showPropertyExchangePanel);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Abre um diálogo para seleção de arquivo CSV.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void browseFile(ActionEvent e) {
&nbsp;        try {
<b class="nc">&nbsp;            JFileChooser fileChooser = new JFileChooser();</b>
<b class="nc">&nbsp;            fileChooser.setCurrentDirectory(new File(System.getProperty(&quot;user.dir&quot;)));</b>
<b class="nc">&nbsp;            fileChooser.setFileSelectionMode(JFileChooser.FILES_ONLY);</b>
<b class="nc">&nbsp;            int returnValue = fileChooser.showOpenDialog(this);</b>
&nbsp;
<b class="nc">&nbsp;            if (returnValue == JFileChooser.APPROVE_OPTION) {</b>
<b class="nc">&nbsp;                File selectedFile = fileChooser.getSelectedFile();</b>
<b class="nc">&nbsp;                if (!selectedFile.exists()) {</b>
<b class="nc">&nbsp;                    throw new IllegalArgumentException(Constants.FILE_NOT_FOUND_ERROR);</b>
&nbsp;                }
<b class="nc">&nbsp;                csvPathInput.setText(selectedFile.getAbsolutePath());</b>
&nbsp;            }
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao selecionar arquivo: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Importa cadastros a partir do arquivo CSV selecionado.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void importCadastros(ActionEvent e) {
<b class="nc">&nbsp;        String path = csvPathInput.getText();</b>
<b class="nc">&nbsp;        if (path.isEmpty()) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
&nbsp;                    Constants.SELECT_FILE_WARNING,
&nbsp;                    Constants.WARNING_TITLE,
&nbsp;                    JOptionPane.WARNING_MESSAGE);
&nbsp;            return;
&nbsp;        }
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            cadastros = Cadastro.getCadastros(path);</b>
&nbsp;            
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_FILE_ERROR);</b>
&nbsp;            }
&nbsp;
&nbsp;            // Habilitar os botões de visualização do grafo e cálculo de média
<b class="nc">&nbsp;            viewPropertyGraphButton.setEnabled(true);</b>
<b class="nc">&nbsp;            viewOwnerGraphButton.setEnabled(true);</b>
<b class="nc">&nbsp;            calculatePropertyAverageButton.setEnabled(true);</b>
<b class="nc">&nbsp;            calculateOwnerAverageButton.setEnabled(true);</b>
<b class="nc">&nbsp;            showPropertyExchangeButton.setEnabled(true);</b>
&nbsp;
<b class="nc">&nbsp;            initializeSortButtons();</b>
<b class="nc">&nbsp;            displayResults();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao importar: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void initializeSortButtons() {
<b class="nc">&nbsp;        sortButtons.clear();</b>
<b class="nc">&nbsp;        int[] sortTypes = {</b>
&nbsp;            Constants.SORT_BY_ID, 
&nbsp;            Constants.SORT_BY_LENGTH, 
&nbsp;            Constants.SORT_BY_AREA, 
&nbsp;            Constants.SORT_BY_OWNER,
&nbsp;            Constants.SORT_BY_FREGUESIA,
&nbsp;            Constants.SORT_BY_CONCELHO,
&nbsp;            Constants.SORT_BY_DISTRICT
&nbsp;        };
&nbsp;
<b class="nc">&nbsp;        for (int i = 0; i &lt; Constants.SORT_BUTTON_LABELS.length; i++) {</b>
<b class="nc">&nbsp;            JButton button = new JButton(Constants.SORT_BUTTON_LABELS[i]);</b>
<b class="nc">&nbsp;            final int sortType = sortTypes[i];</b>
<b class="nc">&nbsp;            button.addActionListener(e -&gt; sortResults(e, sortType));</b>
<b class="nc">&nbsp;            sortButtons.add(button);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Ordena os resultados de acordo com o critério especificado.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     * @param sortType O tipo de ordenação a ser aplicada
&nbsp;     */
&nbsp;    private void sortResults(ActionEvent e, int sortType) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;ordenar&quot;);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            cadastros = Cadastro.sortCadastros(cadastros, sortType);</b>
<b class="nc">&nbsp;            displayResults();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao ordenar: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe os resultados dos cadastros importados na interface.
&nbsp;     */
&nbsp;    private void displayResults() {
&nbsp;        try {
<b class="nc">&nbsp;            resultsPanel.removeAll();</b>
<b class="nc">&nbsp;            addSortButtonsPanel();</b>
<b class="nc">&nbsp;            cadastrosResultPointer = 0;</b>
<b class="nc">&nbsp;            addResults();</b>
<b class="nc">&nbsp;            resultsPanel.add(showMore);</b>
<b class="nc">&nbsp;            resultsPanel.revalidate();</b>
<b class="nc">&nbsp;            resultsPanel.repaint();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao exibir resultados: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void addSortButtonsPanel() {
<b class="nc">&nbsp;        JPanel sortButtonsPanel = new JPanel();</b>
<b class="nc">&nbsp;        sortButtonsPanel.setLayout(new BoxLayout(sortButtonsPanel, BoxLayout.X_AXIS));</b>
<b class="nc">&nbsp;        for (JButton button : sortButtons) {</b>
<b class="nc">&nbsp;            sortButtonsPanel.add(button);</b>
&nbsp;        }
<b class="nc">&nbsp;        resultsPanel.add(sortButtonsPanel);</b>
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Carrega e exibe mais resultados quando o usuário clica no botão &quot;Mais&quot;.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void moreResults(ActionEvent e) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;exibir&quot;);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            int toLoad = cadastrosResultPointer + Constants.DEFAULT_CADASTROS_LOAD;</b>
<b class="nc">&nbsp;            if (toLoad &gt; cadastros.size()) {</b>
<b class="nc">&nbsp;                showMore.setEnabled(false);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            resultsPanel.remove(showMore);</b>
<b class="nc">&nbsp;            addResults();</b>
<b class="nc">&nbsp;            resultsPanel.add(showMore);</b>
<b class="nc">&nbsp;            resultsPanel.revalidate();</b>
<b class="nc">&nbsp;            resultsPanel.repaint();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao carregar mais resultados: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Adiciona um lote de resultados ao painel de visualização.
&nbsp;     */
&nbsp;    private void addResults() {
&nbsp;        try {
<b class="nc">&nbsp;            int toLoad = Math.min(cadastrosResultPointer + Constants.DEFAULT_CADASTROS_LOAD, cadastros.size());</b>
<b class="nc">&nbsp;            for (int i = cadastrosResultPointer; i &lt; toLoad; i++) {</b>
<b class="nc">&nbsp;                showCadastroResult(cadastros.get(i));</b>
&nbsp;            }
<b class="nc">&nbsp;            cadastrosResultPointer = toLoad;</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(&quot;Erro ao adicionar resultados ao painel&quot;, ex);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe as informações de um cadastro específico no painel de resultados.
&nbsp;     * 
&nbsp;     * @param cadastro O objeto Cadastro a ser exibido
&nbsp;     */
&nbsp;    private void showCadastroResult(Cadastro cadastro) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastro == null) {</b>
<b class="nc">&nbsp;                throw new IllegalArgumentException(Constants.NULL_CADASTRO_ERROR);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            JButton cadastroButton = new JButton(Constants.SHOW_SHAPE_BUTTON_TEXT);</b>
<b class="nc">&nbsp;            styleButton(cadastroButton);</b>
<b class="nc">&nbsp;            cadastroButton.addActionListener(e -&gt; showShapeWindow(cadastro));</b>
<b class="nc">&nbsp;            cadastroButton.setPreferredSize(new Dimension(130, 34));</b>
&nbsp;
<b class="nc">&nbsp;            JPanel cardPanel = new JPanel(new BorderLayout(Constants.CARD_PADDING, Constants.CARD_PADDING));</b>
<b class="nc">&nbsp;            cardPanel.setBackground(Color.decode(Constants.CARD_BACKGROUND));</b>
&nbsp;
&nbsp;            // Borda mais sutil com sombra
<b class="nc">&nbsp;            cardPanel.setBorder(BorderFactory.createCompoundBorder(</b>
<b class="nc">&nbsp;                BorderFactory.createLineBorder(new Color(105, 103, 115, 40), 1),</b>
<b class="nc">&nbsp;                BorderFactory.createEmptyBorder(12, 15, 12, 15)</b>
&nbsp;            ));
&nbsp;
<b class="nc">&nbsp;            Location location = cadastro.getLocation();</b>
<b class="nc">&nbsp;            String district = location.freguesia();</b>
<b class="nc">&nbsp;            String municipality = location.concelho();</b>
<b class="nc">&nbsp;            String county = location.distrito();</b>
&nbsp;
&nbsp;            // Criar um painel para as informações com GridBagLayout
<b class="nc">&nbsp;            JPanel infoPanel = new JPanel(new GridBagLayout());</b>
<b class="nc">&nbsp;            infoPanel.setBackground(Color.decode(Constants.CARD_BACKGROUND));</b>
<b class="nc">&nbsp;            GridBagConstraints gbc = new GridBagConstraints();</b>
<b class="nc">&nbsp;            gbc.fill = GridBagConstraints.HORIZONTAL;</b>
<b class="nc">&nbsp;            gbc.anchor = GridBagConstraints.WEST;</b>
<b class="nc">&nbsp;            gbc.weightx = 1.0;</b>
<b class="nc">&nbsp;            gbc.insets = new Insets(0, 5, 0, 5);</b>
&nbsp;
&nbsp;            // ID com destaque em amarelo
<b class="nc">&nbsp;            gbc.gridy = 0;</b>
<b class="nc">&nbsp;            gbc.gridx = 0;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.15;</b>
<b class="nc">&nbsp;            JLabel idLabel = new JLabel(&quot;ID: &quot; + cadastro.getId());</b>
<b class="nc">&nbsp;            idLabel.setFont(idLabel.getFont().deriveFont(Font.BOLD, 13f));</b>
<b class="nc">&nbsp;            idLabel.setForeground(Color.decode(Constants.ACCENT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(idLabel, gbc);</b>
&nbsp;
&nbsp;            // Proprietário
<b class="nc">&nbsp;            gbc.gridx = 1;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.35;</b>
<b class="nc">&nbsp;            JLabel ownerLabel = new JLabel(&quot;Proprietário: &quot; + cadastro.getOwner());</b>
<b class="nc">&nbsp;            ownerLabel.setFont(ownerLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            ownerLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(ownerLabel, gbc);</b>
&nbsp;
&nbsp;            // Área
<b class="nc">&nbsp;            gbc.gridx = 2;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.25;</b>
<b class="nc">&nbsp;            JLabel areaLabel = new JLabel(String.format(&quot;Área: %.2f&quot;,cadastro.getArea()));</b>
<b class="nc">&nbsp;            areaLabel.setFont(areaLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            areaLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(areaLabel, gbc);</b>
&nbsp;
&nbsp;            // Comprimento
<b class="nc">&nbsp;            gbc.gridx = 3;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.25;</b>
<b class="nc">&nbsp;            JLabel lengthLabel = new JLabel(String.format(&quot;Comprimento: %.2f&quot;,cadastro.getLength()));</b>
<b class="nc">&nbsp;            lengthLabel.setFont(lengthLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            lengthLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(lengthLabel, gbc);</b>
&nbsp;
&nbsp;            // Localização com cor mais suave
<b class="nc">&nbsp;            gbc.gridy = 1;</b>
<b class="nc">&nbsp;            gbc.gridx = 0;</b>
<b class="nc">&nbsp;            gbc.gridwidth = 4;</b>
<b class="nc">&nbsp;            gbc.weightx = 1.0;</b>
<b class="nc">&nbsp;            JLabel locationLabel = new JLabel(&quot;Localização: &quot; + district + &quot;, &quot; + municipality + &quot;, &quot; + county);</b>
<b class="nc">&nbsp;            locationLabel.setFont(locationLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            locationLabel.setForeground(Color.decode(Constants.LABEL_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(locationLabel, gbc);</b>
&nbsp;
&nbsp;            // Preço estimado
<b class="nc">&nbsp;            gbc.gridy = 2;</b>
<b class="nc">&nbsp;            gbc.gridx = 0;</b>
<b class="nc">&nbsp;            gbc.gridwidth = 2;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.5;</b>
<b class="nc">&nbsp;            JLabel priceLabel = new JLabel(String.format(&quot;Preço estimado: %.2f€&quot;, cadastro.getPrice()));</b>
<b class="nc">&nbsp;            priceLabel.setFont(priceLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            priceLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(priceLabel, gbc);</b>
&nbsp;
&nbsp;            // Propriedades próximas
<b class="nc">&nbsp;            gbc.gridx = 2;</b>
<b class="nc">&nbsp;            gbc.gridwidth = 2;</b>
<b class="nc">&nbsp;            gbc.weightx = 0.5;</b>
<b class="nc">&nbsp;            JLabel nearLabel = new JLabel(&quot;Propriedades próximas: &quot; + cadastro.getPropretiesNear());</b>
<b class="nc">&nbsp;            nearLabel.setFont(nearLabel.getFont().deriveFont(12f));</b>
<b class="nc">&nbsp;            nearLabel.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
<b class="nc">&nbsp;            infoPanel.add(nearLabel, gbc);</b>
&nbsp;
&nbsp;            // Painel para o botão
<b class="nc">&nbsp;            JPanel buttonPanel = new JPanel(new FlowLayout(FlowLayout.RIGHT, 0, 0));</b>
<b class="nc">&nbsp;            buttonPanel.setBackground(Color.decode(Constants.CARD_BACKGROUND));</b>
<b class="nc">&nbsp;            buttonPanel.setBorder(BorderFactory.createEmptyBorder(0, 10, 0, 0));</b>
<b class="nc">&nbsp;            buttonPanel.add(cadastroButton);</b>
&nbsp;
<b class="nc">&nbsp;            cardPanel.add(infoPanel, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;            cardPanel.add(buttonPanel, BorderLayout.EAST);</b>
&nbsp;
<b class="nc">&nbsp;            resultsPanel.add(cardPanel);</b>
<b class="nc">&nbsp;            resultsPanel.add(Box.createRigidArea(new Dimension(0, 10)));</b>
&nbsp;
<b class="nc">&nbsp;            if (cadastrosResultPointer % Constants.DEFAULT_CADASTROS_LOAD == 0) {</b>
<b class="nc">&nbsp;                resultsPanel.revalidate();</b>
<b class="nc">&nbsp;                resultsPanel.repaint();</b>
&nbsp;            }
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            throw new RuntimeException(&quot;Erro ao exibir cadastro no painel&quot;, ex);</b>
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe uma janela com a forma geométrica do cadastro.
&nbsp;     * 
&nbsp;     * @param cadastro O cadastro cuja forma será exibida
&nbsp;     */
&nbsp;    private void showShapeWindow(Cadastro cadastro) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastro == null) {</b>
<b class="nc">&nbsp;                throw new IllegalArgumentException(Constants.NULL_CADASTRO_ERROR);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            JFrame shapeFrame = new JFrame(Constants.SHAPE_WINDOW_TITLE + cadastro.getId());</b>
<b class="nc">&nbsp;            shapeFrame.setSize(Constants.SHAPE_WINDOW_SIZE, Constants.SHAPE_WINDOW_SIZE);</b>
<b class="nc">&nbsp;            shapeFrame.setLocationRelativeTo(this);</b>
&nbsp;
<b class="nc">&nbsp;            ShapePanel shapePanel = new ShapePanel(cadastro.getShape(), Integer.toString(cadastro.getId()));</b>
<b class="nc">&nbsp;            shapeFrame.add(shapePanel);</b>
&nbsp;
<b class="nc">&nbsp;            shapeFrame.setVisible(true);</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao exibir shape: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe a visualização do grafo de propriedades em uma nova janela.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void showPropertyGraphVisualization(ActionEvent e) {
<b class="nc">&nbsp;        loadingCancelled = false; // Reset flag</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;visualizar grafo de propriedades&quot;);</b>
&nbsp;            }
&nbsp;
&nbsp;            // Criar a janela de carregamento
<b class="nc">&nbsp;            JFrame loadingFrame = new JFrame(Constants.PROPERTY_GRAPH_WINDOW_TITLE);</b>
<b class="nc">&nbsp;            loadingFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;            loadingFrame.setSize(300, 100);</b>
<b class="nc">&nbsp;            loadingFrame.setLocationRelativeTo(this);</b>
&nbsp;            
<b class="nc">&nbsp;            JPanel loadingPanel = new JPanel(new BorderLayout());</b>
<b class="nc">&nbsp;            loadingPanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;            JLabel loadingLabel = new JLabel(&quot;A carregar...&quot;, SwingConstants.CENTER);</b>
<b class="nc">&nbsp;            loadingLabel.setFont(loadingLabel.getFont().deriveFont(Font.BOLD));</b>
<b class="nc">&nbsp;            loadingPanel.add(loadingLabel, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;            loadingFrame.add(loadingPanel);</b>
<b class="nc">&nbsp;            loadingFrame.setVisible(true);</b>
&nbsp;
&nbsp;            // Criar o grafo em uma thread separada
<b class="nc">&nbsp;            propertyGraphWorker = new SwingWorker&lt;PropertyGraph, Void&gt;() {</b>
&nbsp;                @Override
&nbsp;                protected PropertyGraph doInBackground() {
<b class="nc">&nbsp;                    return new PropertyGraph(cadastros);</b>
&nbsp;                }
&nbsp;
&nbsp;                @Override
&nbsp;                protected void done() {
<b class="nc">&nbsp;                    if (isCancelled() || loadingCancelled) return; // Checa a flag!</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        loadingFrame.dispose();</b>
<b class="nc">&nbsp;                        PropertyGraph graph = get();</b>
&nbsp;                        
&nbsp;                        // Criar a janela de visualização do grafo
<b class="nc">&nbsp;                        JFrame graphFrame = new JFrame(Constants.PROPERTY_GRAPH_WINDOW_TITLE);</b>
<b class="nc">&nbsp;                        graphFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
&nbsp;                        
<b class="nc">&nbsp;                        PropertyGraphPanel graphPanel = new PropertyGraphPanel(graph);</b>
<b class="nc">&nbsp;                        JScrollPane scrollPane = new JScrollPane(graphPanel);</b>
<b class="nc">&nbsp;                        scrollPane.setBorder(null);</b>
<b class="nc">&nbsp;                        scrollPane.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
&nbsp;                        
<b class="nc">&nbsp;                        graphFrame.add(scrollPane);</b>
<b class="nc">&nbsp;                        graphFrame.setSize(800, 600);</b>
<b class="nc">&nbsp;                        graphFrame.setLocationRelativeTo(Gui.this);</b>
<b class="nc">&nbsp;                        graphFrame.setVisible(true);</b>
<b class="nc">&nbsp;                    } catch (Exception ex) {</b>
<b class="nc">&nbsp;                        JOptionPane.showMessageDialog(Gui.this,</b>
<b class="nc">&nbsp;                                &quot;Erro ao visualizar grafo de propriedades: &quot; + ex.getMessage(),</b>
&nbsp;                                Constants.ERROR_TITLE,
&nbsp;                                JOptionPane.ERROR_MESSAGE);
&nbsp;                    }
&nbsp;                }
&nbsp;            };
&nbsp;
<b class="nc">&nbsp;            loadingFrame.addWindowListener(new java.awt.event.WindowAdapter() {</b>
&nbsp;                @Override
&nbsp;                public void windowClosing(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    loadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (propertyGraphWorker != null &amp;&amp; !propertyGraphWorker.isDone()) {</b>
<b class="nc">&nbsp;                        propertyGraphWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;                @Override
&nbsp;                public void windowClosed(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    loadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (propertyGraphWorker != null &amp;&amp; !propertyGraphWorker.isDone()) {</b>
<b class="nc">&nbsp;                        propertyGraphWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            propertyGraphWorker.execute();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao visualizar grafo de propriedades: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe a visualização do grafo de proprietários em uma nova janela.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void showOwnerGraphVisualization(ActionEvent e) {
<b class="nc">&nbsp;        ownerLoadingCancelled = false; // Reset flag</b>
&nbsp;
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;visualizar grafo de proprietários&quot;);</b>
&nbsp;            }
&nbsp;
&nbsp;            // Criar a janela de carregamento
<b class="nc">&nbsp;            JFrame loadingFrame = new JFrame(Constants.OWNER_GRAPH_WINDOW_TITLE);</b>
<b class="nc">&nbsp;            loadingFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;            loadingFrame.setSize(300, 100);</b>
<b class="nc">&nbsp;            loadingFrame.setLocationRelativeTo(this);</b>
&nbsp;            
<b class="nc">&nbsp;            JPanel loadingPanel = new JPanel(new BorderLayout());</b>
<b class="nc">&nbsp;            loadingPanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;            JLabel loadingLabel = new JLabel(&quot;A carregar...&quot;, SwingConstants.CENTER);</b>
<b class="nc">&nbsp;            loadingLabel.setFont(loadingLabel.getFont().deriveFont(Font.BOLD));</b>
<b class="nc">&nbsp;            loadingPanel.add(loadingLabel, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;            loadingFrame.add(loadingPanel);</b>
<b class="nc">&nbsp;            loadingFrame.setVisible(true);</b>
&nbsp;
&nbsp;            // Criar o grafo em uma thread separada
<b class="nc">&nbsp;            ownerGraphWorker = new SwingWorker&lt;OwnerGraph, Void&gt;() {</b>
&nbsp;                @Override
&nbsp;                protected OwnerGraph doInBackground() {
<b class="nc">&nbsp;                    return new OwnerGraph(cadastros);</b>
&nbsp;                }
&nbsp;
&nbsp;                @Override
&nbsp;                protected void done() {
<b class="nc">&nbsp;                    if (isCancelled() || ownerLoadingCancelled) return; // Checa a flag!</b>
&nbsp;                    try {
<b class="nc">&nbsp;                        loadingFrame.dispose();</b>
<b class="nc">&nbsp;                        OwnerGraph graph = get();</b>
&nbsp;                        
&nbsp;                        // Criar a janela de visualização do grafo
<b class="nc">&nbsp;                        JFrame graphFrame = new JFrame(Constants.OWNER_GRAPH_WINDOW_TITLE);</b>
<b class="nc">&nbsp;                        graphFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
&nbsp;                        
<b class="nc">&nbsp;                        OwnerGraphPanel graphPanel = new OwnerGraphPanel(graph);</b>
<b class="nc">&nbsp;                        JScrollPane scrollPane = new JScrollPane(graphPanel);</b>
<b class="nc">&nbsp;                        scrollPane.setBorder(null);</b>
<b class="nc">&nbsp;                        scrollPane.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
&nbsp;                        
<b class="nc">&nbsp;                        graphFrame.add(scrollPane);</b>
<b class="nc">&nbsp;                        graphFrame.setSize(800, 600);</b>
<b class="nc">&nbsp;                        graphFrame.setLocationRelativeTo(Gui.this);</b>
<b class="nc">&nbsp;                        graphFrame.setVisible(true);</b>
<b class="nc">&nbsp;                    } catch (Exception ex) {</b>
<b class="nc">&nbsp;                        JOptionPane.showMessageDialog(Gui.this,</b>
<b class="nc">&nbsp;                                &quot;Erro ao visualizar grafo de proprietários: &quot; + ex.getMessage(),</b>
&nbsp;                                Constants.ERROR_TITLE,
&nbsp;                                JOptionPane.ERROR_MESSAGE);
&nbsp;                    }
&nbsp;                }
&nbsp;            };
&nbsp;
<b class="nc">&nbsp;            loadingFrame.addWindowListener(new java.awt.event.WindowAdapter() {</b>
&nbsp;                @Override
&nbsp;                public void windowClosing(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    ownerLoadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (ownerGraphWorker != null &amp;&amp; !ownerGraphWorker.isDone()) {</b>
<b class="nc">&nbsp;                        ownerGraphWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;                @Override
&nbsp;                public void windowClosed(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    ownerLoadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (ownerGraphWorker != null &amp;&amp; !ownerGraphWorker.isDone()) {</b>
<b class="nc">&nbsp;                        ownerGraphWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            ownerGraphWorker.execute();</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao visualizar grafo de proprietários: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe o painel para cálculo da área média de propriedades.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void showPropertyAverageAreaPanel(ActionEvent e) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;calcular área média de propriedades&quot;);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            JFrame averageFrame = new JFrame(Constants.AVERAGE_PROPERTY_AREA_WINDOW_TITLE);</b>
<b class="nc">&nbsp;            averageFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;            averageFrame.setSize(400, 200);</b>
<b class="nc">&nbsp;            averageFrame.setLocationRelativeTo(this);</b>
&nbsp;
<b class="nc">&nbsp;            JPanel panel = new JPanel(new GridLayout(4, 2, Constants.PADDING, Constants.PADDING));</b>
<b class="nc">&nbsp;            panel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;            panel.setBorder(BorderFactory.createEmptyBorder(Constants.PADDING, Constants.PADDING, Constants.PADDING, Constants.PADDING));</b>
&nbsp;
<b class="nc">&nbsp;            JTextField districtField = new JTextField();</b>
<b class="nc">&nbsp;            JTextField municipalityField = new JTextField();</b>
<b class="nc">&nbsp;            JTextField countyField = new JTextField();</b>
<b class="nc">&nbsp;            JLabel resultLabel = new JLabel();</b>
<b class="nc">&nbsp;            resultLabel.setFont(resultLabel.getFont().deriveFont(Font.BOLD));</b>
&nbsp;
&nbsp;            // Estilizar campos de texto
<b class="nc">&nbsp;            styleTextField(districtField);</b>
<b class="nc">&nbsp;            styleTextField(municipalityField);</b>
<b class="nc">&nbsp;            styleTextField(countyField);</b>
&nbsp;
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.DISTRICT_LABEL));</b>
<b class="nc">&nbsp;            panel.add(districtField);</b>
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.MUNICIPALITY_LABEL));</b>
<b class="nc">&nbsp;            panel.add(municipalityField);</b>
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.COUNTY_LABEL));</b>
<b class="nc">&nbsp;            panel.add(countyField);</b>
&nbsp;
<b class="nc">&nbsp;            JButton calculateButton = new JButton(Constants.AVERAGE_PROPERTY_AREA_BUTTON_TEXT);</b>
<b class="nc">&nbsp;            styleButton(calculateButton);</b>
<b class="nc">&nbsp;            calculateButton.addActionListener(event -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    String district = districtField.getText().isEmpty() ? null : districtField.getText();</b>
<b class="nc">&nbsp;                    String municipality = municipalityField.getText().isEmpty() ? null : municipalityField.getText();</b>
<b class="nc">&nbsp;                    String county = countyField.getText().isEmpty() ? null : countyField.getText();</b>
&nbsp;
<b class="nc">&nbsp;                    PropertyGraph graph = new PropertyGraph(cadastros);</b>
<b class="nc">&nbsp;                    double averageArea = graph.calculateAverageArea(district, municipality, county);</b>
<b class="nc">&nbsp;                    resultLabel.setText(String.format(Constants.AVERAGE_AREA_RESULT_FORMAT, averageArea));</b>
<b class="nc">&nbsp;                } catch (IllegalArgumentException ex) {</b>
<b class="nc">&nbsp;                    JOptionPane.showMessageDialog(averageFrame,</b>
<b class="nc">&nbsp;                            ex.getMessage(),</b>
&nbsp;                            Constants.ERROR_TITLE,
&nbsp;                            JOptionPane.ERROR_MESSAGE);
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            panel.add(calculateButton);</b>
<b class="nc">&nbsp;            panel.add(resultLabel);</b>
&nbsp;
<b class="nc">&nbsp;            averageFrame.add(panel);</b>
<b class="nc">&nbsp;            averageFrame.setVisible(true);</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    Constants.AVERAGE_AREA_ERROR + &quot;: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    /**
&nbsp;     * Exibe o painel para cálculo da área média de proprietários.
&nbsp;     * 
&nbsp;     * @param e O evento de ação que disparou o método
&nbsp;     */
&nbsp;    private void showOwnerAverageAreaPanel(ActionEvent e) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;calcular área média de proprietários&quot;);</b>
&nbsp;            }
&nbsp;
<b class="nc">&nbsp;            JFrame averageFrame = new JFrame(Constants.AVERAGE_OWNER_AREA_WINDOW_TITLE);</b>
<b class="nc">&nbsp;            averageFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;            averageFrame.setSize(400, 200);</b>
<b class="nc">&nbsp;            averageFrame.setLocationRelativeTo(this);</b>
&nbsp;
<b class="nc">&nbsp;            JPanel panel = new JPanel(new GridLayout(4, 2, Constants.PADDING, Constants.PADDING));</b>
<b class="nc">&nbsp;            panel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;            panel.setBorder(BorderFactory.createEmptyBorder(Constants.PADDING, Constants.PADDING, Constants.PADDING, Constants.PADDING));</b>
&nbsp;
<b class="nc">&nbsp;            JTextField districtField = new JTextField();</b>
<b class="nc">&nbsp;            JTextField municipalityField = new JTextField();</b>
<b class="nc">&nbsp;            JTextField countyField = new JTextField();</b>
<b class="nc">&nbsp;            JLabel resultLabel = new JLabel();</b>
<b class="nc">&nbsp;            resultLabel.setFont(resultLabel.getFont().deriveFont(Font.BOLD));</b>
&nbsp;
&nbsp;            // Estilizar campos de texto
<b class="nc">&nbsp;            styleTextField(districtField);</b>
<b class="nc">&nbsp;            styleTextField(municipalityField);</b>
<b class="nc">&nbsp;            styleTextField(countyField);</b>
&nbsp;
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.DISTRICT_LABEL));</b>
<b class="nc">&nbsp;            panel.add(districtField);</b>
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.MUNICIPALITY_LABEL));</b>
<b class="nc">&nbsp;            panel.add(municipalityField);</b>
<b class="nc">&nbsp;            panel.add(new JLabel(Constants.COUNTY_LABEL));</b>
<b class="nc">&nbsp;            panel.add(countyField);</b>
&nbsp;
<b class="nc">&nbsp;            JButton calculateButton = new JButton(Constants.AVERAGE_OWNER_AREA_BUTTON_TEXT);</b>
<b class="nc">&nbsp;            styleButton(calculateButton);</b>
<b class="nc">&nbsp;            calculateButton.addActionListener(event -&gt; {</b>
&nbsp;                try {
<b class="nc">&nbsp;                    String district = districtField.getText().isEmpty() ? null : districtField.getText();</b>
<b class="nc">&nbsp;                    String municipality = municipalityField.getText().isEmpty() ? null : municipalityField.getText();</b>
<b class="nc">&nbsp;                    String county = countyField.getText().isEmpty() ? null : countyField.getText();</b>
&nbsp;
<b class="nc">&nbsp;                    OwnerGraph graph = new OwnerGraph(cadastros);</b>
<b class="nc">&nbsp;                    double averageArea = graph.calculateAverageArea(district, municipality, county);</b>
<b class="nc">&nbsp;                    resultLabel.setText(String.format(Constants.AVERAGE_AREA_RESULT_FORMAT, averageArea));</b>
<b class="nc">&nbsp;                } catch (IllegalArgumentException ex) {</b>
<b class="nc">&nbsp;                    JOptionPane.showMessageDialog(averageFrame,</b>
<b class="nc">&nbsp;                            ex.getMessage(),</b>
&nbsp;                            Constants.ERROR_TITLE,
&nbsp;                            JOptionPane.ERROR_MESSAGE);
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            panel.add(calculateButton);</b>
<b class="nc">&nbsp;            panel.add(resultLabel);</b>
&nbsp;
<b class="nc">&nbsp;            averageFrame.add(panel);</b>
<b class="nc">&nbsp;            averageFrame.setVisible(true);</b>
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    Constants.AVERAGE_AREA_ERROR + &quot;: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;    private void styleTextField(JTextField textField) {
<b class="nc">&nbsp;        textField.setBorder(BorderFactory.createCompoundBorder(</b>
<b class="nc">&nbsp;            BorderFactory.createLineBorder(Color.decode(Constants.BORDER_COLOR)),</b>
<b class="nc">&nbsp;            BorderFactory.createEmptyBorder(Constants.TEXT_FIELD_PADDING, Constants.TEXT_FIELD_PADDING, Constants.TEXT_FIELD_PADDING, Constants.TEXT_FIELD_PADDING)</b>
&nbsp;        ));
<b class="nc">&nbsp;        textField.setBackground(Color.WHITE);</b>
<b class="nc">&nbsp;        textField.setForeground(Color.decode(Constants.TEXT_COLOR));</b>
&nbsp;    }
&nbsp;
&nbsp;    private void showPropertyExchangePanel(ActionEvent e) {
&nbsp;        try {
<b class="nc">&nbsp;            if (cadastros == null || cadastros.isEmpty()) {</b>
<b class="nc">&nbsp;                throw new IllegalStateException(Constants.EMPTY_LIST_ERROR + &quot;gerar sugestões de troca&quot;);</b>
&nbsp;            }
&nbsp;
&nbsp;            // Resetar flag
<b class="nc">&nbsp;            exchangeLoadingCancelled = false;</b>
&nbsp;
&nbsp;            // Janela de carregamento
<b class="nc">&nbsp;            JFrame loadingFrame = new JFrame(Constants.PROPERTY_EXCHANGE_WINDOW_TITLE);</b>
<b class="nc">&nbsp;            loadingFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;            loadingFrame.setSize(300, 100);</b>
<b class="nc">&nbsp;            loadingFrame.setLocationRelativeTo(this);</b>
&nbsp;
<b class="nc">&nbsp;            JPanel loadingPanel = new JPanel(new BorderLayout());</b>
<b class="nc">&nbsp;            loadingPanel.setBackground(Color.decode(Constants.BACKGROUND_COLOR));</b>
<b class="nc">&nbsp;            JLabel loadingLabel = new JLabel(&quot;A carregar...&quot;, SwingConstants.CENTER);</b>
<b class="nc">&nbsp;            loadingLabel.setFont(loadingLabel.getFont().deriveFont(Font.BOLD));</b>
<b class="nc">&nbsp;            loadingPanel.add(loadingLabel, BorderLayout.CENTER);</b>
<b class="nc">&nbsp;            loadingFrame.add(loadingPanel);</b>
<b class="nc">&nbsp;            loadingFrame.setVisible(true);</b>
&nbsp;
&nbsp;            // Criar o painel em uma thread separada
<b class="nc">&nbsp;            exchangeWorker = new SwingWorker&lt;PropertyExchangePanel, Void&gt;() {</b>
&nbsp;                @Override
&nbsp;                protected PropertyExchangePanel doInBackground() {
<b class="nc">&nbsp;                    return new PropertyExchangePanel(cadastros, Gui.this);</b>
&nbsp;                }
&nbsp;
&nbsp;                @Override
&nbsp;                protected void done() {
<b class="nc">&nbsp;                    if (isCancelled() || exchangeLoadingCancelled) return;</b>
&nbsp;
&nbsp;                    try {
<b class="nc">&nbsp;                        PropertyExchangePanel exchangePanel = get();</b>
&nbsp;
<b class="nc">&nbsp;                        JFrame exchangeFrame = new JFrame(Constants.PROPERTY_EXCHANGE_WINDOW_TITLE);</b>
<b class="nc">&nbsp;                        exchangeFrame.setDefaultCloseOperation(JFrame.DISPOSE_ON_CLOSE);</b>
<b class="nc">&nbsp;                        exchangeFrame.setSize(800, 600);</b>
<b class="nc">&nbsp;                        exchangeFrame.setLocationRelativeTo(Gui.this);</b>
<b class="nc">&nbsp;                        exchangeFrame.add(exchangePanel);</b>
<b class="nc">&nbsp;                        exchangeFrame.setVisible(true);</b>
&nbsp;
<b class="nc">&nbsp;                    } catch (Exception ex) {</b>
<b class="nc">&nbsp;                        JOptionPane.showMessageDialog(Gui.this,</b>
<b class="nc">&nbsp;                                &quot;Erro ao abrir painel de sugestões: &quot; + ex.getMessage(),</b>
&nbsp;                                Constants.ERROR_TITLE,
&nbsp;                                JOptionPane.ERROR_MESSAGE);
&nbsp;                    } finally {
<b class="nc">&nbsp;                        loadingFrame.dispose();</b>
<b class="nc">&nbsp;                    }</b>
&nbsp;                }
&nbsp;            };
&nbsp;
<b class="nc">&nbsp;            loadingFrame.addWindowListener(new java.awt.event.WindowAdapter() {</b>
&nbsp;                @Override
&nbsp;                public void windowClosing(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    exchangeLoadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (exchangeWorker != null &amp;&amp; !exchangeWorker.isDone()) {</b>
<b class="nc">&nbsp;                        exchangeWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;
&nbsp;                @Override
&nbsp;                public void windowClosed(java.awt.event.WindowEvent e) {
<b class="nc">&nbsp;                    exchangeLoadingCancelled = true;</b>
<b class="nc">&nbsp;                    if (exchangeWorker != null &amp;&amp; !exchangeWorker.isDone()) {</b>
<b class="nc">&nbsp;                        exchangeWorker.cancel(true);</b>
&nbsp;                    }
&nbsp;                }
&nbsp;            });
&nbsp;
<b class="nc">&nbsp;            exchangeWorker.execute();</b>
&nbsp;
<b class="nc">&nbsp;        } catch (Exception ex) {</b>
<b class="nc">&nbsp;            JOptionPane.showMessageDialog(this,</b>
<b class="nc">&nbsp;                    &quot;Erro ao abrir painel de sugestões: &quot; + ex.getMessage(),</b>
&nbsp;                    Constants.ERROR_TITLE,
&nbsp;                    JOptionPane.ERROR_MESSAGE);
&nbsp;        }
&nbsp;    }
&nbsp;
&nbsp;}
</code>
</pre>
</div>

<script type="text/javascript">
(function() {
    var msie = false, msie9 = false;
    /*@cc_on
      msie = true;
      @if (@_jscript_version >= 9)
        msie9 = true;
      @end
    @*/

    if (!msie || msie && msie9) {
      hljs.highlightAll()
      hljs.initLineNumbersOnLoad();
    }
})();
</script>

<div class="footer">
    
    <div style="float:right;">generated on 2025-05-17 22:49</div>
</div>
</body>
</html>
